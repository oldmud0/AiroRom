% Copyright (c) 2015 Benito Palacios Sánchez - All Rights Reserved.
% Esta obra está licenciada bajo la Licencia Creative Commons Atribución 4.0
% Internacional. Para ver una copia de esta licencia, visita
% http://creativecommons.org/licenses/by/4.0/.

\chapter{Conclusiones}
% De qué va el capítulo
A lo largo del trabajo se han analizado una serie de juegos, estudiando los mecanismos de protección que implementan y señalando sus carencias y debilidades.
Todos los objetivos propuestos han sido alcanzados, analizando así un total de 23 juegos de los 20 previstos.
De estos, se han mencionado en esta memoria un total de 14 y documentando el resto en la wiki del repositorio del trabajo\footnote{\url{https://github.com/pleonex/airorom/wiki/Mecanismos-a-investigar}}.

Se plantearon dos objetivos opcionales que por falta de tiempo no se han podido cumplir.
El primero de ellos fue desarrollar un nuevo programa de exploración de juegos.
Tras analizar las necesidades de este trabajo y el tiempo previsto, se decidió optar por usar \textit{Tinke}\footnote{\url{https://github.com/pleonex/tinke}} que cumplía los requirimientos básicos (explorar archivos, reconocer formatos y visualizar imágenes en formatos estándar).
El segundo fue crear un depurador de código para \acl{NDS} llamado \textit{NitroDebugger}\footnote{\url{https://github.com/pleonex/NitroDebugger}} del cual, se ha terminado su núcleo y faltaría crear una interfaz gráfica y desensamblador.
Este proyecto se presentó al \textit{Certamen de Proyectos Libres de la UGR 2014}, a pesar de no estar entre los finalistas debido al estado de completitud, recibió buenas críticas del jurado\footnote{\url{https://goo.gl/g8xdWZ}}.

En cuanto a objetivos académicos, se ha sido capaz de identificar un problema sin tratado (no existen publicaciones en revistas científicas), realizar una selección de objetivos e investigarlos.
Se ha realizado \textit{software} adicional en los lenguajes \texttt{C\#} y \texttt{python} para complementar la investigación y se ha usado un control de versiones (\texttt{git}).
Durante el trabajo se han tocado conceptos de bajo nivel de \textit{software} y \textit{hardware}, estudiando protocolos y componentes de la \acl{NDS}, así como su lenguaje ensamblador, \texttt{ARM}.
Además, se han diseñado estrategias para estudiar las comunicaciones inalámbricas como han sido modificar el emulador DeSmuME para guardar los paquetes y, realizar un diseño \textit{man-in-the-middle} para capturar el tráfico de las aplicaciones móviles.
Finalmente, se ha aprendido el lenguaje \LaTeX para la redacción de esta memoria.

En la primera sección de este capítulo se mencionarán y resumirán los mecanismos encontrados, propiendo en algunos casos métodos para fortalecerlas.
En la segunda sección se indicarán temas en los que este trabajo podría continuar profundizando en el futuro.

\section{Resultados y recomendaciones}
% Resumir cada fallo / seguridad y añadir recomendación
A los largo de la memoria se han analizado una serie de juegos y sus algoritmos.
En esta sección se resumirán los más importantes y se propondrán mejoras en algunos casos.

\subsubsection{Seguridad sobre ficheros}
Los capítulos~\ref{sec:translations} y~\ref{sec:copyright} muestran los procedimientos de seguridad aplicados de ficheros para, evitar su modificación y distribución.
A continuación se enumeran los algoritmos por tipo de formato y se proponen soluciones para mejorar.

Comenzando por el acceso a ficheros, se ha observado dos tipos de protecciones.
La primera consiste en comprimir todos los archivos en uno único, con un formato propietario.
De esta forma, utilizando programas genéricos de exploración de juegos no se pueden extraer los recursos.
Esto se ha visto implementando en el juego \textit{El Profesor Layton y la Llamada del Espectro}\footnote{\url{https://github.com/pleonex/airorom/wiki/Professor-Layton-and-The-Last-Specter}} y \textit{Guitar Hero: On Tours} (sección~\ref{sec:cr-guitarhero}).
En este caso, al utilizar la implementación de \texttt{zlib} para comprimir los datos, el algoritmo visto en ensamblador ocupaba 1900 líneas de código y hacía inviable su investigación.
La segunda técnica consiste en ofuscar el nombre y clasificación de los ficheros como se vio en \textit{Pokémon Blanco y Negro} (sección~\ref{sec:tr-pok-black}).

En cuanto a archivos con contenido de texto, se ha observado que el algoritmo común es realizar un cifrado sobre cada caracter mediante una clave que cambia (juegos de \textit{Pokémon}~\ref{sec:tr-pok}).
Esto provee de un buen mecanismo a nivel de eficiencia y ofuscación, requiriendo conocimientos de depuración para encontrar la clave.
El principal problema es usar la operación \texttt{XOR} con una clave estática en un fichero que tiene varios bytes nulos seguidos, ya que se estaría guardando la contraseña en texto plano dentro del fichero cifrado (caso de \textit{Pokémon Perla} en la tabla de contenidos~\ref{sec:tr-pok-pearl-text} y \textit{Ninokuni}~\ref{sec:tr-nino-text}).
La solución es usar una clave variable, por ejemplo como se hace en los juegos de Pokémon, sumando una constante a esta.

Además, usa una codificación no estándar para los caracteres dificulta la depuración, ya que no se puede encontrar texto ni en archivo binario del juego ni en la memoria RAM.
En este caso, para evitar poder usar técnicas de búsqueda diferencia (programa \textit{RelativeSearch}), se deben desordenar los caracteres mezclando en un mismo rango símbolos y letras.
Finalmente, para evitar que la nueva codificación se pueda obtener a través de la fuente, se debería cifrar este fichero también.

Respecto a las imágenes se encontró en \textit{Pokémon Perla y Diamante} un cifrado basado en la operación \texttt{XOR} con una clave dinámica (sección~\ref{sec:tr-pok-pearl-img}).
A pesar de cifrar un archivo es un buen método para proteger su contenido, en el caso de archivos multimedia debido a la complejidad de implementación para tratar estos contenidos, es mejor crear un nuevo formato.
De esta forma, si se hubiese utilizado otra codificación para los píxeles como representar un color en otro espacio o usando un número variable de bits, se hubiese necesitado crear nuevos programas para procesarlos, más complejos que realizar un bucle que descifre.

Finalmente, tras analizar los archivos con contenido de con derechos de autor como libros digitales (sección~\ref{sec:cr-ebook}), música (sección~\ref{sec:cr-ost}) y vídeos (sección~\ref{sec:cr-video}), no se encontraron mecanismos específico de protección.
A parte de usar codificaciones propietarias como en el caso del sonido \texttt{SADL} (sección~\ref{sec:cr-level5}) y vídeos de \acl{NDS}, los ficheros no estaban cifrados, ni incluían mecanismos de integridad.

\subsubsection{Seguridad en comunicaciones}


\section{Trabajo futuro}
Los estudios de este trabajo han pretendido resumir los mecanimos más frecuentes encontrados en los juegos de \ac{NDS} así como, señalas las carencias de las plataformas móviles.
A continuación se ofrece una lista sobre tópicos en los que los que se podría profundizar.

\begin{itemize}
    \item Estudiar los mecanismos de seguridad implementados en las videoconsolas.
    \item Estudiar los mecanismos anti-copia implementados física y digitalmente sobre los videojuegos y aplicaciones móviles.
    \item Desarrollar un explorador de juegos avanzado, pudiendo detectar algoritmos y formatos ya estudiados.
    \item Terminar la implementación del depurador de código remoto.
    \item Analizar videojuegos de la nueva generación de consolas: \acl{N3DS}, Wii U, \acl{PS4} y \acl{XOne}.
    \item Realizar este estudio sobre aplicaciones de ordenador.
    \item Estudiar los algoritmos \ac{DRM} que aplican plataformas como \textit{Steam}.
    \item Implementar algoritmos propuestos en videojuegos y dispositivos móviles.
    \item Estudiar protocolos usados por videojuegos de aplicaciones móviles para realizar micropagos.
    \item Estudiar los \textit{exploits} que las \textit{flashcard} para \acl{NDS}, \acl{DSi} y \acl{N3DS} utilizan.
    \item Estudiar la integridad en los archivos de guardado (relacionado con el punto anterior).
\end{itemize}
