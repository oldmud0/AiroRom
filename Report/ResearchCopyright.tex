% Copyright (c) 2015 Benito Palacios Sánchez - All Rights Reserved.
% Esta obra está licenciada bajo la Licencia Creative Commons Atribución 4.0
% Internacional. Para ver una copia de esta licencia, visita
% http://creativecommons.org/licenses/by/4.0/.

\chapter{Contenido con derechos de autor}
\label{sec:copyright}
% DRM -> Tipos DRM -> Agujero analógico -> Mi análisis.
La gestión de los derechos de autor ha generado un debate que sigue sin estar resuelto entre la libertad del usuario, y la protección del creador de la obra~\cite{EurAct-CPR}.
Esta industria incluye a los videojuegos, donde la piratería causa pérdidas millonarias\cite{DRM-Game-Carolina}.
De este contexto nace la idea del \ac{DRM}, un mecanismo para imposibilitar la distribución no autorizada de contenido.

Las características de estas técnicas se resumen en detectar quién accede a cada obra, cuándo y bajo qué condiciones, autorizar o denegar de manera inapelable el acceso y autorizarlo bajo condiciones restrictivas~\cite{Wiki-DRM}.
En cuanto a mecanismos que se aplican para evitar la distribución ilegítima, los más comunes son~\cite{DRM-Game-Carolina}:

\begin{itemize}
\item Claves en CD.
Se imprimían en la superficie del CD una clave que se pedía durante la instalación.
La parte negativa es que si se perdía esta clave, el usuario legítimo no podía acceder y, que con una simple búsqueda en Internet se podía obtener.

\item Límite de instalaciones.
Uno de los siguientes métodos fue controlar el número de instalaciones.
Para ello, el producto se tenía que activar realizando una conexión con los servidores de la compañía.
Sin embargo esto requiere que el usuario tenga acceso a Internet, y  que los servidores estén activos.
Además limita el número de dispositivos del usuario.

\item Conexión permanente (\textit{Always-on DRM}\cite{Wiki-AlwaysOn}).
Este método necesita una conexión en cada inicio del juego con los servidores de la compañía, e incluso en algunos casos, durante toda la partida.
Esto ha causado polémica debido a que el usuario no podría jugar sin conexión a Internet y, porque los servidores tienen que estar activos todo el tiempo~\footnote{Algunos juegos de la compañía \textit{Ubisoft} se quedaron sin acceso por tiempo indefinido debido a tareas de mantenimiento de los servidores. \url{http://www.gamespot.com/articles/ubisoft-drm-games-to-be-temporarily-unplayable/1100-6349732/}}.

\item Cifrado del \textit{software}.
Consiste en cifrar la aplicación usando claves asimétricas~\cite{iOS-Encryption}.
Como contrapartida, si el usuario pierde su clave privada y el acceso a ella, no podría volver a ejecutar ninguna aplicación.
\end{itemize}

El principal problema es la posibilidad de aplicar métodos de \emph{ingeniería inversa} sobre el \textit{software} autorizado.
Una vez comprendido cómo una aplicación autorizada accede al contenido protegido, se podría superar los mecanimos de protección para extraer y en algunos casos modificar el recurso.
De aquí vienen la necesidad de trabajar sobre entornos cerrados (capítulo~\ref{sec:art}) cada vez más frecuentes en videoconsolas y móviles\footnote{Los sistemas operativos iOS y Android no permiten el acceso al sistema de ficheros por defecto.}.
Una alternativa sería implementar el algoritmo en \textit{hardware} como es el caso de la \acl{N3DS}.

Aun encontrando un algoritmo eficiente en términos de protección y, sin sobrecarga a la hora de procesado, una vulnerabilidad inevitable es el denominado \textbf{\textit{agujero analógico}}.
La técnica consiste en reconvertir un medio digital en analógico, perdiendo los mecanismos DRM.
Por ejemplo, grabar música que se está reproduciendo con un micrófono, grabar con una cámara una pantalla, escanear un libro o incluso copiarlo a mano.
Estos procedimientos, se utilizan en los videojuegos para, mediante funciones del emulador como capturas de pantalla o grabación de audio, extraer y compartir recursos en páginas como \textit{Spriters Resource}\footnote{\url{http://www.spriters-resource.com/}}.

En las siguientes secciones se analizarán los posibles mecanismos de seguridad que los juegos aplicarían sobre contenido con derechos de autor.
Para ello se han escogido una serie de juegos conocidos por tener materiales, que frecuentemente son protegidos~\cite{SurveyDrm}.
En primer lugar se analizarán juegos con libros electrónicos, a continuación se investigará el género \textit{músical} y la protección sobre el material filmográfico.
El resultado en todos los casos ha sido la carencia de cualquier mecanismo a la hora de proteger los contenidos, exceptuando en el material en formato de vídeo descrito en la última sección.
También destaca la distribución de material adicional como el caso de un libro físico en \textit{Ninokuni} para \acl{NDS} o \textit{hardware} en la saga \textit{Guitar Hero: On Tour}.

\section{Libros electrónicos}
\subsection{Ninokuni: La Ira de la Bruja Blanca}
\textit{Ninokuni: La Ira de la Bruja Blanca} es un juego desarrollado por \textit{Level-5} para \acl{PS3} en el año 2011.
En el capítulo de traducciones no oficiales se expusieron los resultado del análisis de este juego para \acl{NDS}~\ref{sec:tr-nino}.
En esa versión se incluía un libro físico necesario durante el desarrollo del juego.
Sin embargo, en \acl{PS3} se incluye digitalmente y se puede acceder a él mediante un visor integrado en el juego.

El libro se encuentra en el archivo \texttt{hd05\_es.sdat}, dentro de la carpeta raíz y en formato \texttt{PSAR}.
Este tipo de formato, común en juegos de \acs{PS3}, permite agrupar varios archivos y comprimirlos.
La compresión, \texttt{zlib}, se indica claramente con cuatro caracteres en la posición \texttt{0x08} (figura~\ref{fig:met-psar}).
Respecto a la estructura del fichero (tabla~\ref{tab:cr-psar}), tiene una pequeña cabecera, a la que le sigue una tabla de contenidos y los datos.
En GitHub hay repositorios con programas para la extracción de los archivos\footnote{\url{https://github.com/pleonex/Ninokuni/tree/master/Programs/PS3/NinoDecompiler}}.

\ctable[
    caption = Especificación de formato \texttt{PSAR},
    label   = tab:cr-psar,
    pos     = h
]{ccl}{
    \tnote[a] {Los archivos pueden estar comprimidos.}
    \tnote[b] {El primer archivo con código MD5 nulo contiene la lista de nombres y rutas de ficheros.}
}{                                                                      \FL
    Posición      & Tamaño        & Descripción                         \ML
    \multicolumn{3}{c}{Cabecera}                                        \NN
    \texttt{0x00} & \texttt{0x04} & Identificador: \texttt{PSAR}        \NN
    \texttt{0x04} & \texttt{0x04} & Versión: \texttt{0x00010004}        \NN
    \texttt{0x08} & \texttt{0x04} & Compresión: \texttt{zlib}           \NN
    \texttt{0x0C} & \texttt{0x04} & Posición de los datos               \NN
    \texttt{0x10} & \texttt{0x04} & Tamaño de la siguiente sección      \NN
    \texttt{0x14} & \texttt{0x04} & Número de archivos                  \NN
    \texttt{0x18} & \texttt{0x04} & Reservado                           \NN
    \texttt{0x1C} & \texttt{0x04} & Reservado                           \ML
    \multicolumn{3}{c}{\textit{File Info Table}}                        \NN
    \texttt{0x00} & \texttt{0x10} & Código MD5 del nombre del fichero   \NN
    \texttt{0x10} & \texttt{0x04} & Desconocido                         \NN
    \texttt{0x14} & \texttt{0x05} & Posición de los datos               \NN
    \texttt{0x19} & \texttt{0x05} & Tamaño de los datos                 \ML
    \multicolumn{3}{c}{Archivos\tmark[a]\tmark[b]}                      \LL
}

Descomprimiendo el fichero se encuentran nueve archivos, de los cuales destaca uno de 438 MB en \texttt{data/book/es/BigData/gdv.dat} donde se encuentra el libro.
El formato se especifica en la tabla~\ref{tab:cr-gvd}.
Destaca que la codificación de las páginas viene especificada de forma visible con los caracteres \texttt{JPEG} en una de las cabeceras.

\ctable[
    caption = Especificación de formato \texttt{GVD},
    label   = tab:cr-gvd,
]{ccl}{
    \tnote[a]{Hay un bloque por página.}
    \tnote[b]{Relativo al inicio del bloque de datos.}
    \tnote[c]{La codificación del nombre es \texttt{ASCII}.}
    \tnote[d]{Hay un bloque por cada calidad.}
    \tnote[e]{Los datos pueden estar comprimidos en \texttt{GVMP}, en ese
    caso el primer bloque será la imagen \texttt{JPEG}.}
}{                                                                          \FL
    Posición      & Tamaño        & Descripción                             \ML
    \multicolumn{3}{c}{Cabecera}                                            \NN
    \texttt{0x00} & \texttt{0x08} & Identificador: \texttt{TGDT0100}        \NN
    \texttt{0x08} & \texttt{0x04} & Número de páginas                       \NN
    \texttt{0x0C} & \texttt{0x04} & Posición de los datos                   \ML
    \multicolumn{3}{c}{Bloques GVD\tmark[a]}                                \NN
    \texttt{0x00} & \texttt{0x04} & Posición del nombre\tmark[b]\tmark[c]   \NN
    \texttt{0x04} & \texttt{0x04} & Tamaño del nombre                       \NN
    \texttt{0x08} & \texttt{0x04} & Posición de los datos\tmark[b]          \NN
    \texttt{0x0C} & \texttt{0x04} & Tamaño de los datos                     \ML
    \multicolumn{3}{c}{Información de la página}                            \NN
    \texttt{0x00} & \texttt{0x04} & Identificador bloque: \texttt{GVEW0100} \NN
    \texttt{0x04} & \texttt{0x04} & Identificador imagen: \texttt{JPEG0100} \NN
    \texttt{0x08} & \texttt{0x04} & Ancho de la imagen con más calidad      \NN
    \texttt{0x0C} & \texttt{0x04} & Alto de la imagen con más calidad       \NN
    \texttt{0x10} & \texttt{0x04} & Identificador: \texttt{BLK\_}           \NN
    \texttt{0x14} & \texttt{0x04} & Tamaño del bloque                       \NN
    \texttt{0x18} & \texttt{0x04} & ID                                      \NN
    \texttt{0x1C} & \texttt{0x04} & Reservado                               \NN
    \texttt{0x20} & \texttt{0x04} & Constante \texttt{0x20}                 \NN
    \texttt{0x24} & \texttt{0x04} & Constante \texttt{0x04}                 \ML
    \multicolumn{3}{c}{Datos de la página\tmark[d]}                         \NN
    \texttt{0x00} & \texttt{0x04} & Posición X de la imagen en la página    \NN
    \texttt{0x04} & \texttt{0x04} & Posición Y de la imagen en la página    \NN
    \texttt{0x08} & \texttt{0x04} & Calidad                                 \NN
    \texttt{0x0C} & \texttt{0x04} & Tamaño de los datos                     \NN
    \texttt{0x10} & \texttt{0x04} & Desconocido                             \NN
    \texttt{0x14} & \texttt{0x04} & Desconocido                             \NN
    \texttt{0x18} & \texttt{0x04} & Ancho                                   \NN
    \texttt{0x1C} & \texttt{0x04} & Alto                                    \NN
    \texttt{0x20} & Variable      & Imagen \texttt{JPEG}\tmark[e]           \ML
    \multicolumn{3}{c}{GVMP}                                                \NN
    \texttt{0x00} & \texttt{0x04} & Identificador: \texttt{GVMP}            \NN
    \texttt{0x04} & \texttt{0x04} & Número de bloques.                      \NN
    \texttt{0x08} & \texttt{0x04} & Posición de los datos del primer bloque \NN
    \texttt{0x0C} & \texttt{0x04} & Tamaño de los datos del primer bloque   \LL
}

Como se ha podido apreciar, una página se compone de diferentes imágenes \texttt{JPEG} concatenadas.
Tras este análisis, en ninguno de los dos ficheros intermediarios en formato \texttt{PSAR} y \texttt{GVD}, se han encontrado mecanismos que intenten proteger u ofuscar la extracción del libro.
Incluso la codificación de las páginas es estándar.
Como consecuencia, a pesar de que el libro físico de la versión para \acl{NDS} no se llegó a distribuir de forma ilícita en Internet por el trabajo de escanear 300 páginas, el de esta versión si puede ser encontrado fácilmente.

Cabe destacar, que la \acs{PS3} provee de mecanismos nativos para cifrar archivos que sí se usan para proteger el resto de datos del juego como imágenes y textos (archivo \texttt{hs06\_es.adat.sdat}).
Este formatos con extensión \texttt{sdat} y cabecera \texttt{NPD} usa las claves y mecanismos internos de cifrado de la consola que asegura su confidencialidad\footnote{A día de hoy ya se ha podido romper este mecanismo. \url{https://github.com/Hykem/make_npdata}.}.

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item El libro está codificado en un formato propietario, se requiere de \textit{software} no estándar para extraer las páginas.
\end{itemize} &

% Contras
\begin{itemize}
\item El archivo no está cifrado, a pesar de que consola provee de mecanismos para ello que sí se utilizan sobre el resto de los ficheros.
\item La codificación de las páginas es estándar (\texttt{JPEG}).
\end{itemize} \\
\end{tabular}

\subsection{100 Classic Book Collection}
\label{sec:cr-100-books}
\textit{100 Classic Book Collection} fue desarrollado por \textit{HaperCollins} en 2008 para la \acl{NDS}.
No se trata de un juego, si no de una colección de libros junto a un visor, que simular ser un \textit{e-book}.
La aplicación contiene entorno a 100 libros además de descargables.

El formato que contiene los libros no ha presentado ningún mecanismo de protección, siendo incluso más sencillo que el caso anterior (tabla~\ref{tab:cr-100books}).
De los 23 bloques que contiene un libro, el primero tiene información general, del segundo al quinto imágenes de portada y el resto el texto junto a resumen y descripción del autor (figura~\ref{fig:cr-100books}).

\ctable[
    caption = Especificación del formato de \textit{100 Classic Books},
    label   = tab:cr-100books,
    pos     = h
]{ccl}{
    \tnote[a]{Algunos bloques pueden estar vacíos.}
    \tnote[b]{Todos los bloques excepto el primero están comprimidos con \texttt{LZSS}.}
}{                                                                      \FL
    Posición      & Tamaño        & Descripción                         \ML
    \multicolumn{3}{c}{Cabecera}                                        \NN
    \texttt{0x00} & \texttt{0x10} & Desconocido                         \NN
    \texttt{0x10} & \texttt{0x04} & Desconocido                         \NN
    \texttt{0x14} & \texttt{0x04$\times$23} & Puntero a cada bloques    \NN
    \texttt{0x70} & \texttt{0x04$\times$23} & Tamaño de cada bloque     \ML
    \multicolumn{3}{c}{Bloques\tmark[a]\tmark[b]}                       \LL
}

\includefigure{fig:cr-100books}%
{Extracto de texto de un libro de \textit{100 Classic Books Collection}.}%
{imgs/CR-100Books.png}

A pesar de que las obras son clásicas, sin derechos de autor, debería ofrecer una protección por el trabajo de maquetado, traducción y adaptación.

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item No se usa un formato estándar para la representación del texto ni la estructura del libro. Se requiere de programas especializados para extraer y editar.
\end{itemize} &

% Contras
\begin{itemize}
\item Los libros no están cifrados.
\item No hay mecanismos de integridad para protegerlos ante modficaciones.
\end{itemize} \\
\end{tabular}

\section{Bandas sonoras}
\subsection{Osu! Tatakae! Ouendan!}
\textit{Osu! Tatakae! Ouendan!} es un juego japonés desarollado por \textit{iNis} para la \acl{NDS} en 2005.
En occidente salió una segunda versión que usaba el mismo moto, \textit{Elite Beat Agents}.
Son juegos musicales en los que hay que seguir el ritmo de canciones con el lápiz táctil.
Internamente los dos juegos son idénticos cambiando solo el contenido pero no la estructura.

Las canciones están contenidos en un archivo de tipo \texttt{SDAT}, estándar en la consola.
El formato permite almacenar sonido tanto sintetizado como digitalizado.
Para este último se permite las codificaciones \ac{PCM} de 8 bits, \ac{PCM} de 16 bits y \ac{IMA-ADPCM} siendo esta la que más calidad provee y usada en estos juegos (figura~\ref{fig:cr-elite}).

\includefigure{fig:cr-elite}%
{Archivos comprimidos en \texttt{SDAT} y codificados con \acs{IMA-ADPCM} visto con Tinke.}%
{imgs/CR-Elite.png}

A pesar de que estos formatos y codificaciones no proveen protecciones, por motivos técnicos, las canciones vienen fragmentadas y no es inmediata su recomponsición.

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item Las canciones necesitan de procesamiento ya que están dividas en partes.
\end{itemize} &

% Contras
\begin{itemize}
\item Los archivos no están cifrados.
\item Se usa formatos y codificaciones estándar.
\end{itemize} \\
\end{tabular}

\subsection{Guitar Hero: On Tour}
\textit{Guitar Hero: On Tour} es una serie de tres videojuegos para la \textit{Nintendo DS} desarrollados por \textit{Vicarius Visions} y que salieron en 2008 y 2009.
Son juegos musicales donde el jugador simula estar tocando una guitarra a la vez que escucha canciones desde los años 70 hasta la actualidad.
Se caracterizan por incluir una pieza de \textit{hardware} extra e imprescindible para el juego denominado \textit{Guitar Grip}.
Este aparato tiene los cuatro botones que la guitarra simulada que se conectan en el segundo \textit{slot} de la consola.

Gracias a incluir \textit{hardware} adicional hace que no sea posible piratear el juego~(figura~\ref{fig:cr-guitarGrip}), pues no había forma de jugar sin esta
\footnote{Más tarde se descubrió un parche\cite{GTemp-GHhack} para poder jugar usando los botones de la consola y no necesitar \textit{Guitar Grip}.}.

\includefigure{fig:cr-guitarGrip}%
{\textit{Guitar Grip} necesario para jugar a la saga \textit{Guitar Hero: On Tour}.}%
{imgs/CR-GuitarGrip.png}

Analizando el primer juego de la saga, se puede ver que todos los archivos están contenidos en los ficheros \textit{mainFIGS.gfc} y \textit{mainFIGS.gob}. Si bien la estructura del primer fichero parece sencilla: 4 bytes con el tamaño y otros 4 bytes con la posición del fichero.
Sin embargo, el archivo que contiene todos los datos está cifrado.
El código ensamblador con el algoritmo de descifrado cuenta con alrededor de 1900 líneas de instrucciones que hacen muy difícil su comprensión y que, como se comentó en el segundo capítulo, hace que el esfuerzo valga más que el contenido. En concreto, tras tardar entorno a 4 horas en analizar las primeras 200 instrucciones se desistió de la tarea. Más adelante, se pudo encontrar información al respecto del algoritmo, tratándose simplemente de una implementación de \texttt{zlib}~\cite{Ungob}.

Al ser un juego famoso, ha habido investigaciones sobre el formato de los ficheros por lo que el procedimiento de extracción de las canciones está documentado\cite{SH-GH}. La estructura de este formato se describe en la tabla~\ref{tab:cr-guitarHero}.

\ctable[
    caption = Especificación del formato de \textit{Guitar Hero: On Tour},
    label   = tab:cr-guitarHero,
    pos     = h
]{ccl}{
    \tnote[a]{Información extraída de ungob.pl~\cite{Ungob} y corroborada.}
    \tnote[b]{Los datos del fichero están codificados en \textit{big-endian}.}
    \tnote[c]{Se describe la primera entrada.}
    \tnote[d]{Si es el último bloque el valor será \texttt{0x7FFF}.}
}{                                                                          \FL
    Posición      & Tamaño        & Descripción                             \ML
    \multicolumn{3}{c}{Cabecera\tmark[a]\tmark[b]}                          \NN
    \texttt{0x00} & \texttt{0x04} & Identificador: \texttt{0x00008008}      \NN
    \texttt{0x04} & \texttt{0x04} & Tamaño del archivo \texttt{GOB}         \NN
    \texttt{0x08} & \texttt{0x04} & Número de bloques                       \NN
    \texttt{0x0C} & \texttt{0x04} & Número de archivos                      \ML
    \multicolumn{3}{c}{Tabla de bloques\tmark[c]}                           \NN
    \texttt{0x00} & \texttt{0x04} & Tamaño del bloque                       \NN
    \texttt{0x04} & \texttt{0x04} & Posición del bloque                     \NN
    \texttt{0x08} & \texttt{0x04} & Posición del siguiente bloque\tmark[d]  \NN
    \texttt{0x0C} & \texttt{0x04} & Tipo de bloque: \texttt{0x30} descomprimido, \texttt{0x7A} comprimido con \textit{zlib}                              \ML
    \multicolumn{3}{c}{Tabla desconocida\tmark[c]}                          \NN
    \texttt{0x00} & \texttt{0x04} & Desconocido                             \ML
    \multicolumn{3}{c}{Tabla de ficheros\tmark[c]}                          \NN
    \texttt{0x00} & \texttt{0x04} & CRC32 del nombre en minúscula           \NN
    \texttt{0x04} & \texttt{0x04} & Tamaño del fichero                      \NN
    \texttt{0x08} & \texttt{0x04} & Posición del primer bloque              \LL
}

Tras descomprimir este fichero se pueden ver diferentes carpetas y archivos con nombres descriptivos de su contenido. Estas carpetas coinciden en nombre y formato de ficheros con las siguientes versiones del juego que se describen a continuación. Por tanto, esta primera edición del juego provee de buenos mecanismos frente tanto a la distribución ilícita por la necesidad de  \textit{hardware} adicional además de la extracción de canciones mediante un algoritmo largo y complejo de descifrar.

Sin embargo, se encuentra un descuido en las siguientes dos ediciones del juego.
Los archivos no llegaron a ser empaquetados en formato \texttt{GFC} + \texttt{GOB} ni protegidos de ninguna manera.
Se haya dentro del juego las carpetas \textit{StrmFIGS} y \textit{TracksFIGS} (nótese la terminación \textit{FIGS} usada anteriormente para nombrar al archivo \texttt{GOB}).
Dentro se puede encontrar las canciones en formato \texttt{Vorbis OGG} estándar\cite{Xentax-HWAS}.
En concreto, por facilidades técnicas se han separado cada canción en tres archivos, uno con la base de guitarra, otra con la base de batería y otra con la voz.
Las dos primeras están codificadas en \texttt{OGG} y la tercera en \texttt{HWAS}.
Este último formato se trata de \texttt{IMA-ADPCM-Vorbis VOX} con una cabecera de 512 bytes descrita en la tabla~\ref{tab:cr-vox}.
Mezclando las tres pistas se obtiene una versión casi perfecta del audio original.

\ctable[
    caption = Especificación del formato \textit{HWAS},
    label   = tab:cr-vox,
    pos     = h
]{ccl}{

}{                                                                          \FL
    Posición      & Tamaño        & Descripción                             \ML
    \multicolumn{3}{c}{Cabecera\tmark[a]\tmark[b]}                          \NN
    \texttt{0x00} & \texttt{0x04} & Identificador: \texttt{hwas}            \NN
    \texttt{0x04} & \texttt{0x04} & Desconocido                             \NN
    \texttt{0x08} & \texttt{0x04} & Frecuencia de muestreo                  \NN
    \texttt{0x0C} & \texttt{0x04} & Número de canales                       \NN
    \texttt{0x10} & \texttt{0x04} & Reservado                               \NN
    \texttt{0x14} & \texttt{0x04} & Tamaño de los datos de audio            \NN
    \texttt{0x18} & \texttt{0x04} & Número de muestras                      \NN
    \texttt{0x1C} & \texttt{0x1E4} & Reservado                              \ML
    \multicolumn{3}{c}{Datos de audio en IMA-ADPCM}                         \LL
}

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item En la primera edición se comprimen todos los ficheros en un formato difícil de investigar.
\item Los datos están comprimidos en una compresión de 1900 instrucciones máquinas que imposibilita prácticamente su estudio.
\item El formato de algunos ficheros de audio no es estándar y no se puede obtener fácilmente una conversión completamente exacta con programas normales.
\end{itemize} &

% Contras
\begin{itemize}
\item La compresión \textit{zlib} se incluye con información de depuración innecesaria que facilita su comprensión.
\item En las dos ediciones que siguieron a la primera del juego los archivos están sin comprimir y codificar.
\item La mayoría de las canciones vienen codificadas en \textit{OGG} que estándar. Además, se da a conocer este formato mediante la extensión de los ficheros.
\end{itemize} \\
\end{tabular}

\subsection{Guitar Rock}
\textit{Guitar Rock} es un juego desarrollado por \textit{Gameloft} en el año 2008 para la \textit{Nintendo DS}.
Su jugabilidad es muy parecida a la de \textit{Guitar Hero: On Tour} diferenciándose en que no necesita \textit{hardware} como el \textit{Guitar Grip}.

De nuevo las canciones vienen sin proteger dentro del juego encontrándolas dentro de los archivos \textit{trackX.bar}.
Este formato tiene una cabecera de 512 bytes siguiéndole tres pistas musicales de la canción en formato estándar de la \textit{Nintendo DS} \texttt{SWAV}.
Mezclando estas tres pistas se obtiene la canción original sin pérdidas.

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item Los archivos vienen comprimidos en un formato no estándar por lo que no es inmediata su extracción.
\end{itemize} &

% Contras
\begin{itemize}
\item Las canciones no están cifradas y además están codificadas con códecs estándar.
\end{itemize} \\
\end{tabular}

\subsection{Level-5}
El estudio \textit{Level-5} se centra en el desarrollo de juegos para la \textit{Nintendo DS}.
Cabe destacarlo como objeto de estudio pues la banda sonora de juegos tan famosos como \textit{El Profesor Layton}, \textit{Inazuma Eleven} o \textit{Ninokuni} ha estado codificada en un formato propietario y exclusivo.

El formato \texttt{SADL} es un contenedor que admite las codificaciones \acs{IMA-ADPCM} y una desarrollada por el estudio \textit{Procyon}.
Esta última, se trata de una variante de \acs{IMA-ADPCM} con algoritmo predictivo lo que ofrece gran compresión sin pérdida de calidad apenas.

Esto permitió por ejemplo en el caso de \textit{Ninokuni} introducir en el juego una banda sonora grabada por la orquesta de Tokio.
Además, al ser propietario y único para estos juegos tanto el formato de archivo como de codificación de las muestras, dificultó la tarea de extracción y hubieron de pasar varios años hasta que se investigó.
La codificación de este formato se ha investigado y documentado en repositorios de GitHub\footnote{\url{https://github.com/pleonex/SADL-Audio-format}}.

Caso distinto es la versión para \acl{PS3} de este juego dado que el formato de los archivos es estándar y se puede reproducir con programas como \url{http://www.videolan.org/vlc/}{VLC}.
La protección en este juego se centra en el empaquetado de todos los archivos (excepto el libro electrónico) que como se describió en la primera sección viene protegida con una clave propia de la consola.

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item Se ha usado un formato y codificación nueva que requiere el desarrollo de nuevos programas.
\end{itemize} &

% Contras
\begin{itemize}
\item No se provee de cifrado u otro mecanismo de protección más allá del cambio de formato.
\end{itemize} \\
\end{tabular}

\subsection{Duet}
En último lugar se describirá el videojuego \textit{Duet}.
Desarrollado por \textit{Kumobius} para las plataformas Android y iOS en 2013.
La aplicación es de pago pero en periodos de oferta está disponible gratuitamente.

La banda sonora fue compuesta por Tim Shiel y puede comprarse en iTunes\footnote{\url{https://itunes.apple.com/us/album/duet/id721804015}} por \$4.99.
Sin embargo, al igual que pasó con los juegos anteriormente descritos, la seguridad ante una posible extracción se dejó en la capa del binario del juego.
En este caso, si se cuenta con un móvil con acceso al sistema de archivos (\textit{jailbreak} en el caso de iOS) y se accede a la carpeta de la aplicación se puede encontrar toda la banda sonara en formato \texttt{WAV}.

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item Si no se posee de un dispositivo con acceso de \textit{superusuario} no se puede acceder a los audios.
\end{itemize} &

% Contras
\begin{itemize}
\item Los ficheros vienen en formato estándar, sin cifrar y con una extensión que indica su contenido y formato.
\end{itemize} \\
\end{tabular}

\section{Vídeos}
\subsection{\acl{PS3}}
En esta consola, la protección de muchos archivos se confió en la imposibilidad de descifrar archivos con una clave que sólo se conocía por la consola como se discutió con los libros electrónicos.

El formato estándar tiene extensión \texttt{pam} y no es más que una codificación \texttt{MPEG} con una cabecera de 1000 bytes prescindible para su decodificación.
El trabajo se ha documentado en un repositorio de GitHub donde además se ha creado un programar de conversión\footnote{ \url{https://github.com/pleonex/Ninokuni/tree/master/Programs/PS3/pam2mpg}}.

\subsubsection{Conclusión}

\begin{tabular}{p{0.4\textwidth}p{0.5\textwidth}}
Puntos fuertes & Puntos débiles \\
% Pros
\begin{itemize}
\item La cabecera y extensión garantiza que no sea inmediata su extracción.
\end{itemize} &

% Contras
\begin{itemize}
\item Se ha usado una codificación estándar sin cifrado. Sin embargo se entiende en este tipo de contenido debido a los requisitos técnicos de calidad, compresión y eficiencia.
\end{itemize} \\
\end{tabular}

\subsection{\acl{NDS}}
Caso distinto es el de esta consola.
Aun con menos potencia, cinemáticas de alta calidad han sido desarrolladas.
La mayoría de juegos usa una codificación propietaria proporcionada por Nintendo y desarrollada por Mobiclip (tras la compra de Nintendo pasó a llamarse \textit{Nintendo European Research and Development}).

A día de hoy nadie ha sido capaz de estudiar la codificación debido a la complejidad de la misma.
Al estar desarrollada explícitamente para la consola y basarse en piezas específicas de \textit{hardware}, se requiere un tiempo y conocimientos que superan el valor de la misma.
La alternativa a la hora de extraer recursos de este calibre es grabar la pantalla mientras se reproduce el juego en un emulador\footnote{El emulador DeSmuME tiene esta funcionalidad implementada.}.

\subsubsection{Conclusión}

Puntos fuertes
% Pros
\begin{itemize}
\item Al usar una codificación diferente a lo conocido y única para la \acl{NDS}, a pesar de ser la usada en mayoría de los juegos, a fecha de este trabajo nadie ha conseguido crear un descodificador.
\end{itemize}
