 
RAM:02080638 ; =============== S U B R O U T I N E =======================================
RAM:02080638
RAM:02080638
RAM:02080638 decode_unk2                             ; CODE XREF: decode_unk_base_+D80p
RAM:02080638
RAM:02080638 var_50= -0x50
RAM:02080638 var_4C= -0x4C
RAM:02080638 var_48= -0x48
RAM:02080638 var_44= -0x44
RAM:02080638 var_40= -0x40
RAM:02080638 var_3C= -0x3C
RAM:02080638 var_38= -0x38
RAM:02080638 var_34= -0x34
RAM:02080638 var_30= -0x30
RAM:02080638 var_2C= -0x2C
RAM:02080638 var_2A= -0x2A
RAM:02080638 var_28= -0x28
RAM:02080638 var_26= -0x26
RAM:02080638
RAM:02080638 STMFD   SP!, {R4-R11,LR}
RAM:0208063C SUB     SP, SP, #0x2C
RAM:02080640 LDR     R2, [R0,#0x1C]
RAM:02080644 MOV     R8, #1
RAM:02080648 STR     R2, [SP,#0x50+var_30]
RAM:0208064C LDR     R5, [SP,#0x50+var_30]
RAM:02080650 MOV     R3, R2
RAM:02080654 LDR     R6, [R3,#0x4C]
RAM:02080658 LDR     R5, [R5,#0x50]
RAM:0208065C MOV     R7, R8,LSL R6
RAM:02080660 MOV     R6, R8,LSL R5
RAM:02080664 LDR     R8, [SP,#0x50+var_30]
RAM:02080668 LDR     R9, [R0,#0x10]
RAM:0208066C LDR     R8, [R8,#0x20]
RAM:02080670 LDR     R3, [R0,#0xC]
RAM:02080674 STR     R8, [SP,#0x50+var_40]
RAM:02080678 LDR     R8, [SP,#0x50+var_30]
RAM:0208067C LDMIA   R0, {R2,R4}
RAM:02080680 LDR     R12, [R8,#0x28]
RAM:02080684 MOV     R5, 0xFFFFFEFF
RAM:02080688 SUB     R8, R1, R9
RAM:0208068C ADD     R1, R9, R5
RAM:02080690 LDR     R5, [SP,#0x50+var_30]
RAM:02080694 SUB     R3, R3, #1
RAM:02080698 LDR     R5, [R5,#0x24]
RAM:0208069C ADD     R1, R3, R1
RAM:020806A0 STR     R5, [SP,#0x50+var_44]
RAM:020806A4 LDR     R5, [SP,#0x50+var_30]
RAM:020806A8 STR     R1, [SP,#0x50+var_3C]
RAM:020806AC SUB     R1, R7, #1
RAM:020806B0 STR     R1, [SP,#0x50+var_48]
RAM:020806B4 SUB     R1, R6, #1
RAM:020806B8 STR     R1, [SP,#0x50+var_4C]
RAM:020806BC MOV     R1, R5
RAM:020806C0 SUB     R2, R2, #1
RAM:020806C4 SUB     R4, R4, #5
RAM:020806C8 ADD     R4, R2, R4
RAM:020806CC STR     R4, [SP,#0x50+var_34]
RAM:020806D0 SUB     R4, R3, R8
RAM:020806D4 STR     R4, [SP,#0x50+var_38]
RAM:020806D8 LDR     R11, [R5,#0x2C]
RAM:020806DC LDR     LR, [R5,#0x30]
RAM:020806E0 LDR     R4, [R1,#0x34]
RAM:020806E4 LDR     R5, [R1,#0x44]
RAM:020806E8 LDR     R6, [R1,#0x48]
RAM:020806EC LDR     R1, [SP,#0x50+var_40]
RAM:020806F0 ADD     R1, R1, R12
RAM:020806F4 STR     R1, [SP,#0x50+var_50]
RAM:020806F8
RAM:020806F8 loc_20806F8                             ; CODE XREF: decode_unk2+4A8j
RAM:020806F8 CMP     R4, #0xF
RAM:020806FC BCS     loc_2080718
RAM:02080700 LDRB    R8, [R2,#1]
RAM:02080704 LDRB    R7, [R2,#2]!
RAM:02080708 ADD     R1, R4, #8
RAM:0208070C ADD     R8, LR, R8,LSL R4
RAM:02080710 ADD     LR, R8, R7,LSL R1
RAM:02080714 ADD     R4, R4, #0x10
RAM:02080718
RAM:02080718 loc_2080718                             ; CODE XREF: decode_unk2+C4j
RAM:02080718 LDR     R1, [SP,#0x50+var_48]
RAM:0208071C MOV     R8, #1
RAM:02080720 AND     R1, LR, R1
RAM:02080724 MOV     R7, R1,LSL#2
RAM:02080728 ADD     R1, R5, R1,LSL#2
RAM:0208072C LDRH    R7, [R5,R7]
RAM:02080730 LDRH    R1, [R1,#2]
RAM:02080734 STRH    R7, [SP,#0x50+var_2C]
RAM:02080738 STRH    R1, [SP,#0x50+var_2A]
RAM:0208073C
RAM:0208073C loc_208073C                             ; CODE XREF: decode_unk2+464j
RAM:0208073C LDRB    R7, [SP,#0x50+var_2C+1]
RAM:02080740 LDRB    R1, [SP,#0x50+var_2C]
RAM:02080744 MOV     LR, LR,LSR R7
RAM:02080748 SUB     R4, R4, R7
RAM:0208074C CMP     R1, #0
RAM:02080750 BNE     loc_2080764
RAM:02080754 ADD     R3, R3, #1
RAM:02080758 LDRH    R1, [SP,#0x50+var_2A]
RAM:0208075C SWPB    R1, R1, [R3]
RAM:02080760 B       loc_2080AD0
RAM:02080764 ; ---------------------------------------------------------------------------
RAM:02080764
RAM:02080764 loc_2080764                             ; CODE XREF: decode_unk2+118j
RAM:02080764 TST     R1, #0x10
RAM:02080768 BEQ     loc_2080A68
RAM:0208076C ANDS    R1, R1, #0xF
RAM:02080770 LDRH    R7, [SP,#0x50+var_2A]
RAM:02080774 BEQ     loc_20807A4
RAM:02080778 CMP     R4, R1
RAM:0208077C LDRCCB  R8, [R2,#1]!
RAM:02080780 ADDCC   LR, LR, R8,LSL R4
RAM:02080784 MOV     R8, #1
RAM:02080788 MOV     R8, R8,LSL R1
RAM:0208078C SUB     R8, R8, #1
RAM:02080790 AND     R8, LR, R8
RAM:02080794 ADDCC   R4, R4, #8
RAM:02080798 MOV     LR, LR,LSR R1
RAM:0208079C ADD     R7, R7, R8
RAM:020807A0 SUB     R4, R4, R1
RAM:020807A4
RAM:020807A4 loc_20807A4                             ; CODE XREF: decode_unk2+13Cj
RAM:020807A4 CMP     R4, #0xF
RAM:020807A8 BCS     loc_20807C4
RAM:020807AC LDRB    R9, [R2,#1]
RAM:020807B0 LDRB    R8, [R2,#2]!
RAM:020807B4 ADD     R1, R4, #8
RAM:020807B8 ADD     R9, LR, R9,LSL R4
RAM:020807BC ADD     LR, R9, R8,LSL R1
RAM:020807C0 ADD     R4, R4, #0x10
RAM:020807C4
RAM:020807C4 loc_20807C4                             ; CODE XREF: decode_unk2+170j
RAM:020807C4 LDR     R1, [SP,#0x50+var_4C]
RAM:020807C8 MOV     R9, #1
RAM:020807CC AND     R1, LR, R1
RAM:020807D0 MOV     R8, R1,LSL#2
RAM:020807D4 ADD     R1, R6, R1,LSL#2
RAM:020807D8 LDRH    R8, [R6,R8]
RAM:020807DC LDRH    R1, [R1,#2]
RAM:020807E0 STRH    R8, [SP,#0x50+var_28]
RAM:020807E4 STRH    R1, [SP,#0x50+var_26]
RAM:020807E8
RAM:020807E8 loc_20807E8                             ; CODE XREF: decode_unk2+414j
RAM:020807E8 LDRB    R8, [SP,#0x50+var_28+1]
RAM:020807EC LDRB    R1, [SP,#0x50+var_28]
RAM:020807F0 MOV     LR, LR,LSR R8
RAM:020807F4 SUB     R4, R4, R8
RAM:020807F8 TST     R1, #0x10
RAM:020807FC BEQ     loc_2080A18
RAM:02080800 AND     R1, R1, #0xF
RAM:02080804 CMP     R4, R1
RAM:02080808 LDRH    R8, [SP,#0x50+var_26]
RAM:0208080C BCS     loc_208082C
RAM:02080810 LDRB    R9, [R2,#1]!
RAM:02080814 ADD     LR, LR, R9,LSL R4
RAM:02080818 ADD     R4, R4, #8
RAM:0208081C CMP     R4, R1
RAM:02080820 LDRCCB  R9, [R2,#1]!
RAM:02080824 ADDCC   LR, LR, R9,LSL R4
RAM:02080828 ADDCC   R4, R4, #8
RAM:0208082C
RAM:0208082C loc_208082C                             ; CODE XREF: decode_unk2+1D4j
RAM:0208082C MOV     R9, #1
RAM:02080830 MOV     R9, R9,LSL R1
RAM:02080834 SUB     R9, R9, #1
RAM:02080838 AND     R9, LR, R9
RAM:0208083C MOV     LR, LR,LSR R1
RAM:02080840 SUB     R4, R4, R1
RAM:02080844 LDR     R1, [SP,#0x50+var_38]
RAM:02080848 ADD     R8, R8, R9
RAM:0208084C SUB     R1, R3, R1
RAM:02080850 CMP     R8, R1
RAM:02080854 BLS     loc_20809B8
RAM:02080858 SUB     R9, R8, R1
RAM:0208085C LDR     R1, [SP,#0x50+var_44]
RAM:02080860 CMP     R9, R1
RAM:02080864 BLS     loc_2080880
RAM:02080868 LDR     R1, =aInvalidDistanc            ; "invalid distance too far back"
RAM:0208086C MOV     R5, #0x1B
RAM:02080870 STR     R1, [R0,#0x18]
RAM:02080874 LDR     R1, [SP,#0x50+var_30]
RAM:02080878 STR     R5, [R1]
RAM:0208087C B       loc_2080AE4
RAM:02080880 ; ---------------------------------------------------------------------------
RAM:02080880
RAM:02080880 loc_2080880                             ; CODE XREF: decode_unk2+22Cj
RAM:02080880 CMP     R12, #0
RAM:02080884 SUB     R1, R11, #1
RAM:02080888 BNE     loc_20808C0
RAM:0208088C LDR     R10, [SP,#0x50+var_40]
RAM:02080890 CMP     R9, R7
RAM:02080894 SUB     R10, R10, R9
RAM:02080898 ADD     R1, R1, R10
RAM:0208089C BCS     loc_2080954
RAM:020808A0 SUB     R7, R7, R9
RAM:020808A4
RAM:020808A4 loc_20808A4                             ; CODE XREF: decode_unk2+27Cj
RAM:020808A4 ADD     R3, R3, #1
RAM:020808A8 LDRB    R10, [R1,#1]!
RAM:020808AC SUBS    R9, R9, #1
RAM:020808B0 SWPB    R10, R10, [R3]
RAM:020808B4 BNE     loc_20808A4
RAM:020808B8 SUB     R1, R3, R8
RAM:020808BC B       loc_2080954
RAM:020808C0 ; ---------------------------------------------------------------------------
RAM:020808C0
RAM:020808C0 loc_20808C0                             ; CODE XREF: decode_unk2+250j
RAM:020808C0 CMP     R12, R9
RAM:020808C4 BCS     loc_2080928
RAM:020808C8 LDR     R10, [SP,#0x50+var_50]
RAM:020808CC SUB     R10, R10, R9
RAM:020808D0 SUB     R9, R9, R12
RAM:020808D4 ADD     R1, R1, R10
RAM:020808D8 CMP     R9, R7
RAM:020808DC BCS     loc_2080954
RAM:020808E0 SUB     R7, R7, R9
RAM:020808E4
RAM:020808E4 loc_20808E4                             ; CODE XREF: decode_unk2+2BCj
RAM:020808E4 ADD     R3, R3, #1
RAM:020808E8 LDRB    R10, [R1,#1]!
RAM:020808EC SUBS    R9, R9, #1
RAM:020808F0 SWPB    R10, R10, [R3]
RAM:020808F4 BNE     loc_20808E4
RAM:020808F8 CMP     R12, R7
RAM:020808FC SUB     R1, R11, #1
RAM:02080900 BCS     loc_2080954
RAM:02080904 MOV     R9, R12
RAM:02080908 SUB     R7, R7, R12
RAM:0208090C
RAM:0208090C loc_208090C                             ; CODE XREF: decode_unk2+2E4j
RAM:0208090C ADD     R3, R3, #1
RAM:02080910 LDRB    R10, [R1,#1]!
RAM:02080914 SUBS    R9, R9, #1
RAM:02080918 SWPB    R10, R10, [R3]
RAM:0208091C BNE     loc_208090C
RAM:02080920 SUB     R1, R3, R8
RAM:02080924 B       loc_2080954
RAM:02080928 ; ---------------------------------------------------------------------------
RAM:02080928
RAM:02080928 loc_2080928                             ; CODE XREF: decode_unk2+28Cj
RAM:02080928 CMP     R9, R7
RAM:0208092C SUB     R10, R12, R9
RAM:02080930 ADD     R1, R1, R10
RAM:02080934 BCS     loc_2080954
RAM:02080938 SUB     R7, R7, R9
RAM:0208093C
RAM:0208093C loc_208093C                             ; CODE XREF: decode_unk2+314j
RAM:0208093C ADD     R3, R3, #1
RAM:02080940 LDRB    R10, [R1,#1]!
RAM:02080944 SUBS    R9, R9, #1
RAM:02080948 SWPB    R10, R10, [R3]
RAM:0208094C BNE     loc_208093C
RAM:02080950 SUB     R1, R3, R8
RAM:02080954
RAM:02080954 loc_2080954                             ; CODE XREF: decode_unk2+264j
RAM:02080954                                         ; decode_unk2+284j ...
RAM:02080954 CMP     R7, #2
RAM:02080958 BLS     loc_208098C
RAM:0208095C
RAM:0208095C loc_208095C                             ; CODE XREF: decode_unk2+350j
RAM:0208095C LDRB    R8, [R1,#1]
RAM:02080960 ADD     R9, R3, #1
RAM:02080964 ADD     R10, R3, #2
RAM:02080968 SWPB    R8, R8, [R9]
RAM:0208096C ADD     R3, R3, #3
RAM:02080970 LDRB    R8, [R1,#2]
RAM:02080974 SUB     R7, R7, #3
RAM:02080978 CMP     R7, #2
RAM:0208097C SWPB    R8, R8, [R10]
RAM:02080980 LDRB    R8, [R1,#3]!
RAM:02080984 SWPB    R8, R8, [R3]
RAM:02080988 BHI     loc_208095C
RAM:0208098C
RAM:0208098C loc_208098C                             ; CODE XREF: decode_unk2+320j
RAM:0208098C CMP     R7, #0
RAM:02080990 BEQ     loc_2080AD0
RAM:02080994 CMP     R7, #1
RAM:02080998 ADD     R3, R3, #1
RAM:0208099C LDRB    R7, [R1,#1]
RAM:020809A0 SWPB    R7, R7, [R3]
RAM:020809A4 BLS     loc_2080AD0
RAM:020809A8 LDRB    R1, [R1,#2]
RAM:020809AC ADD     R3, R3, #1
RAM:020809B0 SWPB    R1, R1, [R3]
RAM:020809B4 B       loc_2080AD0
RAM:020809B8 ; ---------------------------------------------------------------------------
RAM:020809B8
RAM:020809B8 loc_20809B8                             ; CODE XREF: decode_unk2+21Cj
RAM:020809B8 SUB     R1, R3, R8
RAM:020809BC
RAM:020809BC loc_20809BC                             ; CODE XREF: decode_unk2+3B0j
RAM:020809BC LDRB    R8, [R1,#1]
RAM:020809C0 ADD     R9, R3, #1
RAM:020809C4 ADD     R10, R3, #2
RAM:020809C8 SWPB    R8, R8, [R9]
RAM:020809CC ADD     R3, R3, #3
RAM:020809D0 LDRB    R8, [R1,#2]
RAM:020809D4 SUB     R7, R7, #3
RAM:020809D8 CMP     R7, #2
RAM:020809DC SWPB    R8, R8, [R10]
RAM:020809E0 LDRB    R8, [R1,#3]!
RAM:020809E4 SWPB    R8, R8, [R3]
RAM:020809E8 BHI     loc_20809BC
RAM:020809EC CMP     R7, #0
RAM:020809F0 BEQ     loc_2080AD0
RAM:020809F4 CMP     R7, #1
RAM:020809F8 ADD     R3, R3, #1
RAM:020809FC LDRB    R7, [R1,#1]
RAM:02080A00 SWPB    R7, R7, [R3]
RAM:02080A04 BLS     loc_2080AD0
RAM:02080A08 LDRB    R1, [R1,#2]
RAM:02080A0C ADD     R3, R3, #1
RAM:02080A10 SWPB    R1, R1, [R3]
RAM:02080A14 B       loc_2080AD0
RAM:02080A18 ; ---------------------------------------------------------------------------
RAM:02080A18
RAM:02080A18 loc_2080A18                             ; CODE XREF: decode_unk2+1C4j
RAM:02080A18 TST     R1, #0x40
RAM:02080A1C BNE     loc_2080A50
RAM:02080A20 MOV     R1, R9,LSL R1
RAM:02080A24 SUB     R1, R1, #1
RAM:02080A28 AND     R1, LR, R1
RAM:02080A2C LDRH    R8, [SP,#0x50+var_26]
RAM:02080A30 ADD     R8, R8, R1
RAM:02080A34 MOV     R1, R8,LSL#2
RAM:02080A38 ADD     R8, R6, R8,LSL#2
RAM:02080A3C LDRH    R1, [R6,R1]
RAM:02080A40 LDRH    R8, [R8,#2]
RAM:02080A44 STRH    R1, [SP,#0x50+var_28]
RAM:02080A48 STRH    R8, [SP,#0x50+var_26]
RAM:02080A4C B       loc_20807E8
RAM:02080A50 ; ---------------------------------------------------------------------------
RAM:02080A50
RAM:02080A50 loc_2080A50                             ; CODE XREF: decode_unk2+3E4j
RAM:02080A50 LDR     R1, =aInvalidDista_0            ; "invalid distance code"
RAM:02080A54 MOV     R5, #0x1B
RAM:02080A58 STR     R1, [R0,#0x18]
RAM:02080A5C LDR     R1, [SP,#0x50+var_30]
RAM:02080A60 STR     R5, [R1]
RAM:02080A64 B       loc_2080AE4
RAM:02080A68 ; ---------------------------------------------------------------------------
RAM:02080A68
RAM:02080A68 loc_2080A68                             ; CODE XREF: decode_unk2+130j
RAM:02080A68 TST     R1, #0x40
RAM:02080A6C BNE     loc_2080AA0
RAM:02080A70 MOV     R1, R8,LSL R1
RAM:02080A74 SUB     R1, R1, #1
RAM:02080A78 AND     R1, LR, R1
RAM:02080A7C LDRH    R7, [SP,#0x50+var_2A]
RAM:02080A80 ADD     R1, R7, R1
RAM:02080A84 MOV     R7, R1,LSL#2
RAM:02080A88 ADD     R1, R5, R1,LSL#2
RAM:02080A8C LDRH    R7, [R5,R7]
RAM:02080A90 LDRH    R1, [R1,#2]
RAM:02080A94 STRH    R7, [SP,#0x50+var_2C]
RAM:02080A98 STRH    R1, [SP,#0x50+var_2A]
RAM:02080A9C B       loc_208073C
RAM:02080AA0 ; ---------------------------------------------------------------------------
RAM:02080AA0
RAM:02080AA0 loc_2080AA0                             ; CODE XREF: decode_unk2+434j
RAM:02080AA0 TST     R1, #0x20
RAM:02080AA4 BEQ     loc_2080AB8
RAM:02080AA8 LDR     R1, [SP,#0x50+var_30]
RAM:02080AAC MOV     R5, #0xB
RAM:02080AB0 STR     R5, [R1]
RAM:02080AB4 B       loc_2080AE4
RAM:02080AB8 ; ---------------------------------------------------------------------------
RAM:02080AB8
RAM:02080AB8 loc_2080AB8                             ; CODE XREF: decode_unk2+46Cj
RAM:02080AB8 LDR     R1, =aInvalidLiteral            ; "invalid literal/length code"
RAM:02080ABC MOV     R5, #0x1B
RAM:02080AC0 STR     R1, [R0,#0x18]
RAM:02080AC4 LDR     R1, [SP,#0x50+var_30]
RAM:02080AC8 STR     R5, [R1]
RAM:02080ACC B       loc_2080AE4
RAM:02080AD0 ; ---------------------------------------------------------------------------
RAM:02080AD0
RAM:02080AD0 loc_2080AD0                             ; CODE XREF: decode_unk2+128j
RAM:02080AD0                                         ; decode_unk2+358j ...
RAM:02080AD0 LDR     R1, [SP,#0x50+var_34]
RAM:02080AD4 CMP     R2, R1
RAM:02080AD8 LDRCC   R1, [SP,#0x50+var_3C]
RAM:02080ADC CMPCC   R3, R1
RAM:02080AE0 BCC     loc_20806F8
RAM:02080AE4
RAM:02080AE4 loc_2080AE4                             ; CODE XREF: decode_unk2+244j
RAM:02080AE4                                         ; decode_unk2+42Cj ...
RAM:02080AE4 MOV     R1, R4,LSR#3
RAM:02080AE8 SUB     R5, R2, R4,LSR#3
RAM:02080AEC SUB     R4, R4, R1,LSL#3
RAM:02080AF0 MOV     R1, #1
RAM:02080AF4 MOV     R2, R1,LSL R4
RAM:02080AF8 ADD     R1, R5, #1
RAM:02080AFC STR     R1, [R0]
RAM:02080B00 ADD     R1, R3, #1
RAM:02080B04 STR     R1, [R0,#0xC]
RAM:02080B08 LDR     R1, [SP,#0x50+var_34]
RAM:02080B0C SUB     R2, R2, #1
RAM:02080B10 CMP     R5, R1
RAM:02080B14 SUBCC   R1, R1, R5
RAM:02080B18 ADDCC   R1, R1, #5
RAM:02080B1C SUBCS   R1, R5, R1
RAM:02080B20 RSBCS   R1, R1, #5
RAM:02080B24 STR     R1, [R0,#4]
RAM:02080B28 LDR     R1, [SP,#0x50+var_3C]
RAM:02080B2C AND     LR, LR, R2
RAM:02080B30 CMP     R3, R1
RAM:02080B34 LDRCS   R2, =0x101
RAM:02080B38 SUBCS   R1, R3, R1
RAM:02080B3C SUBCS   R1, R2, R1
RAM:02080B40 BCS     loc_2080B50
RAM:02080B44 SUB     R1, R1, R3
RAM:02080B48 ADD     R1, R1, #1
RAM:02080B4C ADD     R1, R1, #0x100
RAM:02080B50
RAM:02080B50 loc_2080B50                             ; CODE XREF: decode_unk2+508j
RAM:02080B50 STR     R1, [R0,#0x10]
RAM:02080B54 LDR     R0, [SP,#0x50+var_30]
RAM:02080B58 STR     LR, [R0,#0x30]
RAM:02080B5C STR     R4, [R0,#0x34]
RAM:02080B60 ADD     SP, SP, #0x2C
RAM:02080B64 LDMFD   SP!, {R4-R11,PC}
RAM:02080B64 ; End of function decode_unk2
RAM:02080B64
RAM:02080B64 ; ---------------------------------------------------------------------------
RAM:02080B68 off_2080B68 DCD aInvalidDistanc         ; DATA XREF: decode_unk2+230r
RAM:02080B68                                         ; "invalid distance too far back"
RAM:02080B6C off_2080B6C DCD aInvalidDista_0         ; DATA XREF: decode_unk2:loc_2080A50r
RAM:02080B6C                                         ; "invalid distance code"
RAM:02080B70 off_2080B70 DCD aInvalidLiteral         ; DATA XREF: decode_unk2:loc_2080AB8r
RAM:02080B70                                         ; "invalid literal/length code"
RAM:02080B74 dword_2080B74 DCD 0x101                 ; DATA XREF: decode_unk2+4FCr
